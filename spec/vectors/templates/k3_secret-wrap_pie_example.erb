  it '<%= name %>' do
    <%- if unwrapped -%>
    unwrapped = Paseto::Util.decode_hex('<%= unwrapped %>')
    <%- end -%>
    wrapping_key = Paseto::Util.decode_hex('<%= wrapping_key %>')
    <%- if public_key -%>
    public_key = <%= [public_key + '0A'].pack("H*").inspect %>
    <%- end -%>
    paserk = '<%= paserk %>'
    nonce = Paseto::Util.decode_hex('63bb3202832c059662ed9949e3116b78b7428bb7105a9207dde8d443958844c4')

    <%- if expect_fail -%>
    expect do
      Paseto::Key.unwrap(paserk: paserk, wrapping_key: wrapping_key)
    end.to raise_error(Paseto::InvalidAuthenticator)
    <%- else -%>
    key = Paseto::Key.unwrap(paserk: paserk, wrapping_key: wrapping_key)
    expect(key.public_to_pem).to eq(public_key)
    expect(key.wrap(wrapping_key)).to start_with('k3.secret-wrap.pie.')
    <%- end -%>
  end
